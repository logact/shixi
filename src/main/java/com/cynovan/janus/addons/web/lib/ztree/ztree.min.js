(function(e){var d={},t={},a={},o={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},n={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},i=function(e){var d=g.getRoot(e);d||(d={},g.setRoot(e,d)),d[e.data.key.children]=[],d.expandTriggerFlag=!1,d.curSelectedList=[],d.noSelection=!0,d.createdNodes=[],d.zId=0,d._ver=new Date().getTime()},r=function(e){var d=g.getCache(e);d||(d={},g.setCache(e,d)),d.nodes=[],d.doms=[]},l=function(e){var d=e.treeObj,t=T.event;d.bind(t.NODECREATED,function(d,t,a){k.apply(e.callback.onNodeCreated,[d,t,a])}),d.bind(t.CLICK,function(d,t,a,o,n){k.apply(e.callback.onClick,[t,a,o,n])}),d.bind(t.EXPAND,function(d,t,a){k.apply(e.callback.onExpand,[d,t,a])}),d.bind(t.COLLAPSE,function(d,t,a){k.apply(e.callback.onCollapse,[d,t,a])}),d.bind(t.ASYNC_SUCCESS,function(d,t,a,o){k.apply(e.callback.onAsyncSuccess,[d,t,a,o])}),d.bind(t.ASYNC_ERROR,function(d,t,a,o,n,i){k.apply(e.callback.onAsyncError,[d,t,a,o,n,i])}),d.bind(t.REMOVE,function(d,t,a){k.apply(e.callback.onRemove,[d,t,a])}),d.bind(t.SELECTED,function(d,t,a){k.apply(e.callback.onSelected,[t,a])}),d.bind(t.UNSELECTED,function(d,t,a){k.apply(e.callback.onUnSelected,[t,a])})},c=function(e){var d=e.treeObj,t=T.event;d.unbind(t.NODECREATED).unbind(t.CLICK).unbind(t.EXPAND).unbind(t.COLLAPSE).unbind(t.ASYNC_SUCCESS).unbind(t.ASYNC_ERROR).unbind(t.REMOVE).unbind(t.SELECTED).unbind(t.UNSELECTED)},s=function(e){var d=e.target,t=g.getSetting(e.data.treeId),a="",o=null,n="",i="",r=null,l=null,c=null;k.eqs(e.type,"mousedown")?i="mousedown":k.eqs(e.type,"mouseup")?i="mouseup":k.eqs(e.type,"contextmenu")?i="contextmenu":k.eqs(e.type,"click")?k.eqs(d.tagName,"span")&&null!==d.getAttribute("treeNode"+T.id.SWITCH)?(a=k.getNodeMainDom(d).id,n="switchNode"):(c=k.getMDom(t,d,[{tagName:"a",attrName:"treeNode"+T.id.A}]),c&&(a=k.getNodeMainDom(c).id,n="clickNode")):k.eqs(e.type,"dblclick")&&(i="dblclick",c=k.getMDom(t,d,[{tagName:"a",attrName:"treeNode"+T.id.A}]),c&&(a=k.getNodeMainDom(c).id,n="switchNode")),0<i.length&&0==a.length&&(c=k.getMDom(t,d,[{tagName:"a",attrName:"treeNode"+T.id.A}]),c&&(a=k.getNodeMainDom(c).id));0<a.length&&(o=g.getNodeCache(t,a),"switchNode"==n?o.isParent?k.eqs(e.type,"click")||k.eqs(e.type,"dblclick")&&k.apply(t.view.dblClickExpand,[t.treeId,o],t.view.dblClickExpand)?r=y.onSwitchNode:n="":n="":"clickNode"==n?r=y.onClickNode:void 0);"mousedown"==i?l=y.onZTreeMousedown:"mouseup"==i?l=y.onZTreeMouseup:"dblclick"==i?l=y.onZTreeDblclick:"contextmenu"==i?l=y.onZTreeContextmenu:void 0;var s={stop:!1,node:o,nodeEventType:n,nodeEventCallback:r,treeEventType:i,treeEventCallback:l};return s},h=function(e,d,t,a,o,n){if(t){var i=g.getRoot(e),r=e.data.key.children;t.level=d,t.tId=e.treeId+"_"+ ++i.zId,t.parentTId=a?a.tId:null,t.open="string"==typeof t.open?k.eqs(t.open,"true"):!!t.open,t[r]&&0<t[r].length?(t.isParent=!0,t.zAsync=!0):(t.isParent="string"==typeof t.isParent?k.eqs(t.isParent,"true"):!!t.isParent,t.open=t.isParent&&!e.async.enable&&t.open,t.zAsync=!t.isParent),t.isFirstNode=o,t.isLastNode=n,t.getParentNode=function(){return g.getNodeCache(e,t.parentTId)},t.getPreNode=function(){return g.getPreNode(e,t)},t.getNextNode=function(){return g.getNextNode(e,t)},t.getIndex=function(){return g.getNodeIndex(e,t)},t.getPath=function(){return g.getNodePath(e,t)},t.isAjaxing=!1,g.fixPIdKeyValue(e,t)}},p={bind:[l],unbind:[c],caches:[r],nodes:[h],proxys:[s],roots:[i],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},g={addNodeCache:function(e,d){g.getCache(e).nodes[g.getNodeCacheId(d.tId)]=d},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){p.afterA.push(e)},addBeforeA:function(e){p.beforeA.push(e)},addInnerAfterA:function(e){p.innerAfterA.push(e)},addInnerBeforeA:function(e){p.innerBeforeA.push(e)},addInitBind:function(e){p.bind.push(e)},addInitUnBind:function(e){p.unbind.push(e)},addInitCache:function(e){p.caches.push(e)},addInitNode:function(e){p.nodes.push(e)},addInitProxy:function(e,d){!d?p.proxys.push(e):p.proxys.splice(0,0,e)},addInitRoot:function(e){p.roots.push(e)},addNodesData:function(e,d,t,a){var o,n=e.data.key.children;d[n]?t>=d[n].length&&(t=-1):(d[n]=[],t=-1),0<d[n].length&&0===t?(d[n][0].isFirstNode=!1,C.setNodeLineIcos(e,d[n][0])):0<d[n].length&&0>t&&(d[n][d[n].length-1].isLastNode=!1,C.setNodeLineIcos(e,d[n][d[n].length-1])),d.isParent=!0,0>t?d[n]=d[n].concat(a):(o=[t,0].concat(a),d[n].splice.apply(d[n],o))},addSelectedNode:function(e,d){var t=g.getRoot(e);g.isSelectedNode(e,d)||t.curSelectedList.push(d)},addCreatedNode:function(e,d){if(!!e.callback.onNodeCreated||!!e.view.addDiyDom){var t=g.getRoot(e);t.createdNodes.push(d)}},addZTreeTools:function(e){p.zTreeTools.push(e)},exSetting:function(d){e.extend(!0,n,d)},fixPIdKeyValue:function(e,d){e.data.simpleData.enable&&(d[e.data.simpleData.pIdKey]=d.parentTId?d.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(){for(var e=0,d=p.afterA.length;e<d;e++)p.afterA[e].apply(this,arguments)},getBeforeA:function(){for(var e=0,d=p.beforeA.length;e<d;e++)p.beforeA[e].apply(this,arguments)},getInnerAfterA:function(){for(var e=0,d=p.innerAfterA.length;e<d;e++)p.innerAfterA[e].apply(this,arguments)},getInnerBeforeA:function(){for(var e=0,d=p.innerBeforeA.length;e<d;e++)p.innerBeforeA[e].apply(this,arguments)},getCache:function(e){return a[e.treeId]},getNodeIndex:function(e,d){if(!d)return null;for(var t=e.data.key.children,a=d.parentTId?d.getParentNode():g.getRoot(e),o=0,n=a[t].length-1;o<=n;o++)if(a[t][o]===d)return o;return-1},getNextNode:function(e,d){if(!d)return null;for(var t=e.data.key.children,a=d.parentTId?d.getParentNode():g.getRoot(e),o=0,n=a[t].length-1;o<=n;o++)if(a[t][o]===d)return o==n?null:a[t][o+1];return null},getNodeByParam:function(e,d,t,a){if(!d||!t)return null;for(var o=e.data.key.children,n=0,i=d.length;n<i;n++){if(d[n][t]==a)return d[n];var r=g.getNodeByParam(e,d[n][o],t,a);if(r)return r}return null},getNodeCache:function(e,d){if(!d)return null;var t=a[e.treeId].nodes[g.getNodeCacheId(d)];return t?t:null},getNodeName:function(e,d){var t=e.data.key.name;return""+d[t]},getNodePath:function(e,d){if(!d)return null;var t;return t=d.parentTId?d.getParentNode().getPath():[],t&&t.push(d),t},getNodeTitle:function(e,d){var a=""===e.data.key.title?e.data.key.name:e.data.key.title;return""+d[a]},getNodes:function(e){return g.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,d,t,a){if(!d||!t)return[];for(var o=e.data.key.children,n=[],r=0,i=d.length;r<i;r++)d[r][t]==a&&n.push(d[r]),n=n.concat(g.getNodesByParam(e,d[r][o],t,a));return n},getNodesByParamFuzzy:function(e,d,t,a){if(!d||!t)return[];var o=e.data.key.children,n=[];a=a.toLowerCase();for(var r=0,i=d.length;r<i;r++)"string"==typeof d[r][t]&&-1<d[r][t].toLowerCase().indexOf(a)&&n.push(d[r]),n=n.concat(g.getNodesByParamFuzzy(e,d[r][o],t,a));return n},getNodesByFilter:function(e,d,t,a,o){if(!d)return a?null:[];for(var n=e.data.key.children,r=a?null:[],c=0,i=d.length;c<i;c++){if(k.apply(t,[d[c],o],!1)){if(a)return d[c];r.push(d[c])}var l=g.getNodesByFilter(e,d[c][n],t,a,o);if(a&&!!l)return l;r=a?l:r.concat(l)}return r},getPreNode:function(e,d){if(!d)return null;for(var t=e.data.key.children,a=d.parentTId?d.getParentNode():g.getRoot(e),o=0,n=a[t].length;o<n;o++)if(a[t][o]===d)return 0==o?null:a[t][o-1];return null},getRoot:function(e){return e?t[e.treeId]:null},getRoots:function(){return t},getSetting:function(e){return d[e]},getSettings:function(){return d},getZTreeTools:function(e){var d=this.getRoot(this.getSetting(e));return d?d.treeTools:null},initCache:function(){for(var e=0,d=p.caches.length;e<d;e++)p.caches[e].apply(this,arguments)},initNode:function(){for(var e=0,d=p.nodes.length;e<d;e++)p.nodes[e].apply(this,arguments)},initRoot:function(){for(var e=0,d=p.roots.length;e<d;e++)p.roots[e].apply(this,arguments)},isSelectedNode:function(e,d){for(var t=g.getRoot(e),a=0,o=t.curSelectedList.length;a<o;a++)if(d===t.curSelectedList[a])return!0;return!1},removeNodeCache:function(e,d){var t=e.data.key.children;if(d[t])for(var a=0,o=d[t].length;a<o;a++)g.removeNodeCache(e,d[t][a]);g.getCache(e).nodes[g.getNodeCacheId(d.tId)]=null},removeSelectedNode:function(e,d){for(var t=g.getRoot(e),a=0,o=t.curSelectedList.length;a<o;a++)d!==t.curSelectedList[a]&&g.getNodeCache(e,t.curSelectedList[a].tId)||(t.curSelectedList.splice(a,1),e.treeObj.trigger(T.event.UNSELECTED,[e.treeId,d]),a--,o--)},setCache:function(e,d){a[e.treeId]=d},setRoot:function(e,d){t[e.treeId]=d},setZTreeTools:function(){for(var e=0,d=p.zTreeTools.length;e<d;e++)p.zTreeTools[e].apply(this,arguments)},transformToArrayFormat:function(e,d){if(!d)return[];var t=e.data.key.children,a=[];if(k.isArray(d))for(var o=0,n=d.length;o<n;o++)a.push(d[o]),d[o][t]&&(a=a.concat(g.transformToArrayFormat(e,d[o][t])));else a.push(d),d[t]&&(a=a.concat(g.transformToArrayFormat(e,d[t])));return a},transformTozTreeFormat:function(e,d){var t,a,o=e.data.simpleData.idKey,n=e.data.simpleData.pIdKey,i=e.data.key.children;if(!o||""==o||!d)return[];if(k.isArray(d)){var l=[],r=[];for(t=0,a=d.length;t<a;t++)r[d[t][o]]=d[t];for(t=0,a=d.length;t<a;t++)r[d[t][n]]&&d[t][o]!=d[t][n]?(r[d[t][n]][i]||(r[d[t][n]][i]=[]),r[d[t][n]][i].push(d[t])):l.push(d[t]);return l}return[d]}},N={bindEvent:function(){for(var e=0,d=p.bind.length;e<d;e++)p.bind[e].apply(this,arguments)},unbindEvent:function(){for(var e=0,d=p.unbind.length;e<d;e++)p.unbind[e].apply(this,arguments)},bindTree:function(e){var d={treeId:e.treeId},t=e.treeObj;e.view.txtSelectedEnable||t.bind("selectstart",y.onSelectStart).css({"-moz-user-select":"-moz-none"}),t.bind("click",d,N.proxy),t.bind("dblclick",d,N.proxy),t.bind("mouseover",d,N.proxy),t.bind("mouseout",d,N.proxy),t.bind("mousedown",d,N.proxy),t.bind("mouseup",d,N.proxy),t.bind("contextmenu",d,N.proxy)},unbindTree:function(e){var d=e.treeObj;d.unbind("selectstart",y.onSelectStart).unbind("click",N.proxy).unbind("dblclick",N.proxy).unbind("mouseover",N.proxy).unbind("mouseout",N.proxy).unbind("mousedown",N.proxy).unbind("mouseup",N.proxy).unbind("contextmenu",N.proxy)},doProxy:function(){for(var e,d=[],t=0,a=p.proxys.length;t<a&&(e=p.proxys[t].apply(this,arguments),d.push(e),!e.stop);t++);return d},proxy:function(d){var e=g.getSetting(d.data.treeId);if(!k.uCanDo(e,d))return!0;for(var t,a=N.doProxy(d),o=!0,n=!1,r=0,i=a.length;r<i;r++)t=a[r],t.nodeEventCallback&&(n=!0,o=t.nodeEventCallback.apply(t,[d,t.node])&&o),t.treeEventCallback&&(n=!0,o=t.treeEventCallback.apply(t,[d,t.node])&&o);return o}},y={onSwitchNode:function(e,d){var t=g.getSetting(e.data.treeId);if(d.open){if(!1==k.apply(t.callback.beforeCollapse,[t.treeId,d],!0))return!0;g.getRoot(t).expandTriggerFlag=!0,C.switchNode(t,d)}else{if(!1==k.apply(t.callback.beforeExpand,[t.treeId,d],!0))return!0;g.getRoot(t).expandTriggerFlag=!0,C.switchNode(t,d)}return!0},onClickNode:function(e,d){var t=g.getSetting(e.data.treeId),a=t.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&g.isSelectedNode(t,d)?0:t.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&t.view.selectedMulti?2:1;return!(!1!=k.apply(t.callback.beforeClick,[t.treeId,d,a],!0))||(0==a?C.cancelPreSelectedNode(t,d):C.selectNode(t,d,2==a),t.treeObj.trigger(T.event.CLICK,[e,t.treeId,d,a]),!0)},onZTreeMousedown:function(e,d){var t=g.getSetting(e.data.treeId);return k.apply(t.callback.beforeMouseDown,[t.treeId,d],!0)&&k.apply(t.callback.onMouseDown,[e,t.treeId,d]),!0},onZTreeMouseup:function(e,d){var t=g.getSetting(e.data.treeId);return k.apply(t.callback.beforeMouseUp,[t.treeId,d],!0)&&k.apply(t.callback.onMouseUp,[e,t.treeId,d]),!0},onZTreeDblclick:function(e,d){var t=g.getSetting(e.data.treeId);return k.apply(t.callback.beforeDblClick,[t.treeId,d],!0)&&k.apply(t.callback.onDblClick,[e,t.treeId,d]),!0},onZTreeContextmenu:function(e,d){var t=g.getSetting(e.data.treeId);return k.apply(t.callback.beforeRightClick,[t.treeId,d],!0)&&k.apply(t.callback.onRightClick,[e,t.treeId,d]),"function"!=typeof t.callback.onRightClick},onSelectStart:function(d){var e=d.originalEvent.srcElement.nodeName.toLowerCase();return"input"===e||"textarea"===e}},k={apply:function(e,d,t){return"function"==typeof e?e.apply(u,d?d:[]):t},canAsync:function(e,d){var t=e.data.key.children;return e.async.enable&&d&&d.isParent&&!(d.zAsync||d[t]&&0<d[t].length)},clone:function(e){if(null===e)return null;var d=k.isArray(e)?[]:{};for(var t in e)d[t]=e[t]instanceof Date?new Date(e[t].getTime()):"object"==typeof e[t]?k.clone(e[t]):e[t];return d},eqs:function(e,d){return e.toLowerCase()===d.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},$:function(d,t,a){return!t||"string"==typeof t||(a=t,t=""),"string"==typeof d?e(d,a?a.treeObj.get(0).ownerDocument:null):e("#"+d.tId+t,a?a.treeObj:null)},getMDom:function(e,d,t){if(!d)return null;for(;d&&d.id!==e.treeId;){for(var a=0,o=t.length;d.tagName&&a<o;a++)if(k.eqs(d.tagName,t[a].tagName)&&null!==d.getAttribute(t[a].attrName))return d;d=d.parentNode}return null},getNodeMainDom:function(d){return e(d).parent("li").get(0)||e(d).parentsUntil("li").parent().get(0)},isChildOrSelf:function(d,t){return 0<e(d).closest("#"+t).length},uCanDo:function(){return!0}},C={addNodes:function(e,d,t,a,o){if(!(e.data.keep.leaf&&d&&!d.isParent))if(k.isArray(a)||(a=[a]),e.data.simpleData.enable&&(a=g.transformTozTreeFormat(e,a)),d){var n=m(d,T.id.SWITCH,e),i=m(d,T.id.ICON,e),r=m(d,T.id.UL,e);d.open||(C.replaceSwitchClass(d,n,T.folder.CLOSE),C.replaceIcoClass(d,i,T.folder.CLOSE),d.open=!1,r.css({display:"none"})),g.addNodesData(e,d,t,a),C.createNodes(e,d.level+1,a,d,t),o||C.expandCollapseParentNode(e,d,!0)}else g.addNodesData(e,g.getRoot(e),t,a),C.createNodes(e,0,a,null,t)},appendNodes:function(e,d,t,a,o,n,r){if(!t)return[];var c,s,h=[],p=e.data.key.children,N=a?a:g.getRoot(e),y=N[p];(!y||o>=y.length)&&(o=-1);for(var k,u=0,i=t.length;u<i;u++){k=t[u],n&&(c=(0===o||y.length==t.length)&&0==u,s=0>o&&u==t.length-1,g.initNode(e,d,k,a,c,s,r),g.addNodeCache(e,k));var l=[];k[p]&&0<k[p].length&&(l=C.appendNodes(e,d+1,k[p],k,-1,n,r&&k.open)),r&&(C.makeDOMNodeMainBefore(h,e,k),C.makeDOMNodeLine(h,e,k),g.getBeforeA(e,k,h),C.makeDOMNodeNameBefore(h,e,k),g.getInnerBeforeA(e,k,h),C.makeDOMNodeIcon(h,e,k),g.getInnerAfterA(e,k,h),C.makeDOMNodeNameAfter(h,e,k),g.getAfterA(e,k,h),k.isParent&&k.open&&C.makeUlHtml(e,k,h,l.join("")),C.makeDOMNodeMainAfter(h,e,k),g.addCreatedNode(e,k))}return h},appendParentULDom:function(e,d){var t=[],a=m(d,e);a.get(0)||!d.parentTId||(C.appendParentULDom(e,d.getParentNode()),a=m(d,e));var o=m(d,T.id.UL,e);o.get(0)&&o.remove();var n=e.data.key.children,i=C.appendNodes(e,d.level+1,d[n],d,-1,!1,!0);C.makeUlHtml(e,d,t,i.join("")),a.append(t.join(""))},asyncNode:function(d,t,a,o){var n,i;if(t&&!t.isParent)return k.apply(o),!1;if(t&&t.isAjaxing)return!1;if(!1==k.apply(d.callback.beforeAsync,[d.treeId,t],!0))return k.apply(o),!1;if(t){t.isAjaxing=!0;var r=m(t,T.id.ICON,d);r.attr({style:"",class:T.className.BUTTON+" "+T.className.ICO_LOADING})}var l={};for(n=0,i=d.async.autoParam.length;t&&n<i;n++){var c=d.async.autoParam[n].split("="),s=c;1<c.length&&(s=c[1],c=c[0]),l[s]=t[c]}if(k.isArray(d.async.otherParam))for(n=0,i=d.async.otherParam.length;n<i;n+=2)l[d.async.otherParam[n]]=d.async.otherParam[n+1];else for(var h in d.async.otherParam)l[h]=d.async.otherParam[h];var p=g.getRoot(d)._ver;return e.ajax({contentType:d.async.contentType,cache:!1,type:d.async.type,url:k.apply(d.async.url,[d.treeId,t],d.async.url),data:l,dataType:d.async.dataType,success:function(e){if(p==g.getRoot(d)._ver){var n=[];try{n=e&&0!=e.length?"string"==typeof e?eval("("+e+")"):e:[]}catch(d){n=e}t&&(t.isAjaxing=null,t.zAsync=!0),C.setNodeLineIcos(d,t),n&&""!==n?(n=k.apply(d.async.dataFilter,[d.treeId,t,n],n),C.addNodes(d,t,-1,n?k.clone(n):[],!!a)):C.addNodes(d,t,-1,[],!!a),d.treeObj.trigger(T.event.ASYNC_SUCCESS,[d.treeId,t,e]),k.apply(o)}},error:function(e,a,o){p!=g.getRoot(d)._ver||(t&&(t.isAjaxing=null),C.setNodeLineIcos(d,t),d.treeObj.trigger(T.event.ASYNC_ERROR,[d.treeId,t,e,a,o]))}}),!0},cancelPreSelectedNode:function(e,d,t){var a,o,n=g.getRoot(e).curSelectedList;for(a=n.length-1;0<=a;a--)if(o=n[a],d===o||!d&&(!t||t!==o))if(m(o,T.id.A,e).removeClass(T.node.CURSELECTED),d){g.removeSelectedNode(e,d);break}else n.splice(a,1),e.treeObj.trigger(T.event.UNSELECTED,[e.treeId,o])},createNodeCallback:function(e){if(!!e.callback.onNodeCreated||!!e.view.addDiyDom)for(var d,t=g.getRoot(e);0<t.createdNodes.length;)d=t.createdNodes.shift(),k.apply(e.view.addDiyDom,[e.treeId,d]),!e.callback.onNodeCreated||e.treeObj.trigger(T.event.NODECREATED,[e.treeId,d])},createNodes:function(d,t,a,o,n){if(a&&0!=a.length){var i=g.getRoot(d),r=d.data.key.children,l=!o||o.open||!!m(o[r][0],d).get(0);i.createdNodes=[];var c,s,h=C.appendNodes(d,t,a,o,n,!0,l);if(!o)c=d.treeObj;else{var p=m(o,T.id.UL,d);p.get(0)&&(c=p)}c&&(0<=n&&(s=c.children()[n]),0<=n&&s?e(s).before(h.join("")):c.append(h.join(""))),C.createNodeCallback(d)}},destroy:function(e){e&&(g.initCache(e),g.initRoot(e),N.unbindTree(e),N.unbindEvent(e),e.treeObj.empty(),delete d[e.treeId])},expandCollapseNode:function(e,d,t,a,o){var n,i,r=g.getRoot(e),l=e.data.key.children;if(!d)return void k.apply(o,[]);if(r.expandTriggerFlag&&(i=o,n=function(){i&&i(),d.open?e.treeObj.trigger(T.event.EXPAND,[e.treeId,d]):e.treeObj.trigger(T.event.COLLAPSE,[e.treeId,d])},o=n,r.expandTriggerFlag=!1),!d.open&&d.isParent&&(!m(d,T.id.UL,e).get(0)||d[l]&&0<d[l].length&&!m(d[l][0],e).get(0))&&(C.appendParentULDom(e,d),C.createNodeCallback(e)),d.open==t)return void k.apply(o,[]);var c=m(d,T.id.UL,e),s=m(d,T.id.SWITCH,e),h=m(d,T.id.ICON,e);d.isParent?(d.open=!d.open,d.iconOpen&&d.iconClose&&h.attr("style",C.makeNodeIcoStyle(e,d)),d.open?(C.replaceSwitchClass(d,s,T.folder.OPEN),C.replaceIcoClass(d,h,T.folder.OPEN),!1==a||""==e.view.expandSpeed?(c.show(),k.apply(o,[])):d[l]&&0<d[l].length?c.slideDown(e.view.expandSpeed,o):(c.show(),k.apply(o,[]))):(C.replaceSwitchClass(d,s,T.folder.CLOSE),C.replaceIcoClass(d,h,T.folder.CLOSE),!1!=a&&""!=e.view.expandSpeed&&d[l]&&0<d[l].length?c.slideUp(e.view.expandSpeed,o):(c.hide(),k.apply(o,[])))):k.apply(o,[])},expandCollapseParentNode:function(e,d,t,a,o){if(d){if(!d.parentTId)return void C.expandCollapseNode(e,d,t,a,o);C.expandCollapseNode(e,d,t,a),d.parentTId&&C.expandCollapseParentNode(e,d.getParentNode(),t,a,o)}},expandCollapseSonNode:function(e,d,t,a,o){var n=g.getRoot(e),r=e.data.key.children,c=d?d[r]:n[r],s=g.getRoot(e).expandTriggerFlag;if(g.getRoot(e).expandTriggerFlag=!1,c)for(var h=0,i=c.length;h<i;h++)c[h]&&C.expandCollapseSonNode(e,c[h],t,!d&&a);g.getRoot(e).expandTriggerFlag=s,C.expandCollapseNode(e,d,t,a,o)},isSelectedNode:function(e,d){if(!d)return!1;var t,a=g.getRoot(e).curSelectedList;for(t=a.length-1;0<=t;t--)if(d===a[t])return!0;return!1},makeDOMNodeIcon:function(e,d,t){var a=g.getNodeName(d,t),o=d.view.nameIsHTML?a:a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",t.tId,T.id.ICON,"' title='' treeNode",T.id.ICON," class='",C.makeNodeIcoClass(d,t),"' style='",C.makeNodeIcoStyle(d,t),"'></span><span id='",t.tId,T.id.SPAN,"' class='",T.className.NAME,"'>",o,"</span>")},makeDOMNodeLine:function(e,d,t){e.push("<span id='",t.tId,T.id.SWITCH,"' title='' class='",C.makeNodeLineClass(d,t),"' treeNode",T.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e){e.push("</li>")},makeDOMNodeMainBefore:function(e,d,t){e.push("<li id='",t.tId,"' class='",T.className.LEVEL,t.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e){e.push("</a>")},makeDOMNodeNameBefore:function(e,d,t){var a=g.getNodeTitle(d,t),o=C.makeNodeUrl(d,t),n=C.makeNodeFontCss(d,t),i=[];for(var r in n)i.push(r,":",n[r],";");e.push("<a id='",t.tId,T.id.A,"' class='",T.className.LEVEL,t.level,"' treeNode",T.id.A," onclick=\"",t.click||"","\" ",null!=o&&0<o.length?"href='"+o+"'":""," target='",C.makeNodeTarget(t),"' style='",i.join(""),"'"),k.apply(d.view.showTitle,[d.treeId,t],d.view.showTitle)&&a&&e.push("title='",a.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,d){var t=k.apply(e.view.fontCss,[e.treeId,d],e.view.fontCss);return t&&"function"!=typeof t?t:{}},makeNodeIcoClass:function(e,d){var t=["ico"];return d.isAjaxing||(t[0]=(d.iconSkin?d.iconSkin+"_":"")+t[0],d.isParent?t.push(d.open?T.folder.OPEN:T.folder.CLOSE):t.push(T.folder.DOCU)),T.className.BUTTON+" "+t.join("_")},makeNodeIcoStyle:function(e,d){var t=[];if(!d.isAjaxing){var a=d.isParent&&d.iconOpen&&d.iconClose?d.open?d.iconOpen:d.iconClose:d[e.data.key.icon];a&&t.push("background:url(",a,") 0 0 no-repeat;"),!1!=e.view.showIcon&&k.apply(e.view.showIcon,[e.treeId,d],!0)||t.push("width:0px;height:0px;")}return t.join("")},makeNodeLineClass:function(e,d){var t=[];return e.view.showLine?0==d.level&&d.isFirstNode&&d.isLastNode?t.push(T.line.ROOT):0==d.level&&d.isFirstNode?t.push(T.line.ROOTS):d.isLastNode?t.push(T.line.BOTTOM):t.push(T.line.CENTER):t.push(T.line.NOLINE),d.isParent?t.push(d.open?T.folder.OPEN:T.folder.CLOSE):t.push(T.folder.DOCU),C.makeNodeLineClassEx(d)+t.join("_")},makeNodeLineClassEx:function(e){return T.className.BUTTON+" "+T.className.LEVEL+e.level+" "+T.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,d){var t=e.data.key.url;return d[t]?d[t]:null},makeUlHtml:function(e,d,t,a){t.push("<ul id='",d.tId,T.id.UL,"' class='",T.className.LEVEL,d.level," ",C.makeUlLineClass(e,d),"' style='display:",d.open?"block":"none","'>"),t.push(a),t.push("</ul>")},makeUlLineClass:function(e,d){return e.view.showLine&&!d.isLastNode?T.line.LINE:""},removeChildNodes:function(e,d){if(d){var t=e.data.key.children,a=d[t];if(a){for(var o=0,n=a.length;o<n;o++)g.removeNodeCache(e,a[o]);if(g.removeSelectedNode(e),delete d[t],!e.data.keep.parent){d.isParent=!1,d.open=!1;var i=m(d,T.id.SWITCH,e),r=m(d,T.id.ICON,e);C.replaceSwitchClass(d,i,T.folder.DOCU),C.replaceIcoClass(d,r,T.folder.DOCU),m(d,T.id.UL,e).remove()}else m(d,T.id.UL,e).empty()}}},scrollIntoView:function(e){if(e)if(e.scrollIntoViewIfNeeded)e.scrollIntoViewIfNeeded();else if(e.scrollIntoView)e.scrollIntoView(!1);else try{e.focus().blur()}catch(d){}},setFirstNode:function(e,d){var t=e.data.key.children,a=d[t].length;0<a&&(d[t][0].isFirstNode=!0)},setLastNode:function(e,d){var t=e.data.key.children,a=d[t].length;0<a&&(d[t][a-1].isLastNode=!0)},removeNode:function(e,d){var t=g.getRoot(e),a=e.data.key.children,o=d.parentTId?d.getParentNode():t;if(d.isFirstNode=!1,d.isLastNode=!1,d.getPreNode=function(){return null},d.getNextNode=function(){return null},!!g.getNodeCache(e,d.tId)){m(d,e).remove(),g.removeNodeCache(e,d),g.removeSelectedNode(e,d);for(var n=0,i=o[a].length;n<i;n++)if(o[a][n].tId==d.tId){o[a].splice(n,1);break}C.setFirstNode(e,o),C.setLastNode(e,o);var r,l,c,s=o[a].length;if(!e.data.keep.parent&&0==s)o.isParent=!1,o.open=!1,r=m(o,T.id.UL,e),l=m(o,T.id.SWITCH,e),c=m(o,T.id.ICON,e),C.replaceSwitchClass(o,l,T.folder.DOCU),C.replaceIcoClass(o,c,T.folder.DOCU),r.css("display","none");else if(e.view.showLine&&0<s){var h=o[a][s-1];if(r=m(h,T.id.UL,e),l=m(h,T.id.SWITCH,e),c=m(h,T.id.ICON,e),o!=t)C.replaceSwitchClass(h,l,T.line.BOTTOM);else if(1==o[a].length)C.replaceSwitchClass(h,l,T.line.ROOT);else{var p=m(o[a][0],T.id.SWITCH,e);C.replaceSwitchClass(o[a][0],p,T.line.ROOTS),C.replaceSwitchClass(h,l,T.line.BOTTOM)}r.removeClass(T.line.LINE)}}},replaceIcoClass:function(e,d,t){if(d&&!e.isAjaxing){var a=d.attr("class");if(void 0!=a){var o=a.split("_");t===T.folder.OPEN||t===T.folder.CLOSE||t===T.folder.DOCU?o[o.length-1]=t:void 0,d.attr("class",o.join("_"))}}},replaceSwitchClass:function(e,d,t){if(d){var a=d.attr("class");if(void 0!=a){var o=a.split("_");t===T.line.ROOT||t===T.line.ROOTS||t===T.line.CENTER||t===T.line.BOTTOM||t===T.line.NOLINE?o[0]=C.makeNodeLineClassEx(e)+t:t===T.folder.OPEN||t===T.folder.CLOSE||t===T.folder.DOCU?o[1]=t:void 0,d.attr("class",o.join("_")),t===T.folder.DOCU?d.attr("disabled","disabled"):d.removeAttr("disabled")}}},selectNode:function(e,d,t){t||C.cancelPreSelectedNode(e,null,d),m(d,T.id.A,e).addClass(T.node.CURSELECTED),g.addSelectedNode(e,d),e.treeObj.trigger(T.event.SELECTED,[e.treeId,d])},setNodeFontCss:function(e,d){var t=m(d,T.id.A,e),a=C.makeNodeFontCss(e,d);a&&t.css(a)},setNodeLineIcos:function(e,d){if(d){var t=m(d,T.id.SWITCH,e),a=m(d,T.id.UL,e),o=m(d,T.id.ICON,e),n=C.makeUlLineClass(e,d);0==n.length?a.removeClass(T.line.LINE):a.addClass(n),t.attr("class",C.makeNodeLineClass(e,d)),d.isParent?t.removeAttr("disabled"):t.attr("disabled","disabled"),o.removeAttr("style"),o.attr("style",C.makeNodeIcoStyle(e,d)),o.attr("class",C.makeNodeIcoClass(e,d))}},setNodeName:function(e,d){var t=g.getNodeTitle(e,d),a=m(d,T.id.SPAN,e);if(a.empty(),e.view.nameIsHTML?a.html(g.getNodeName(e,d)):a.text(g.getNodeName(e,d)),k.apply(e.view.showTitle,[e.treeId,d],e.view.showTitle)){var o=m(d,T.id.A,e);o.attr("title",t?t:"")}},setNodeTarget:function(e,d){var t=m(d,T.id.A,e);t.attr("target",C.makeNodeTarget(d))},setNodeUrl:function(e,d){var t=m(d,T.id.A,e),a=C.makeNodeUrl(e,d);null==a||0==a.length?t.removeAttr("href"):t.attr("href",a)},switchNode:function(e,d){if(d.open||!k.canAsync(e,d))C.expandCollapseNode(e,d,!d.open);else if(!e.async.enable)d&&C.expandCollapseNode(e,d,!d.open);else if(!C.asyncNode(e,d))return void C.expandCollapseNode(e,d,!d.open)}};e.fn.zTree={consts:o,_z:{tools:k,view:C,event:N,data:g},getZTreeObj:function(e){var d=g.getZTreeTools(e);return d?d:null},destroy:function(e){if(!!e&&0<e.length)C.destroy(g.getSetting(e));else for(var t in d)C.destroy(d[t])},init:function(t,a,o){var c=k.clone(n);e.extend(!0,c,a),c.treeId=t.attr("id"),c.treeObj=t,c.treeObj.empty(),d[c.treeId]=c,"undefined"==typeof document.body.style.maxHeight&&(c.view.expandSpeed=""),g.initRoot(c);var i=g.getRoot(c),r=c.data.key.children;o=o?k.clone(k.isArray(o)?o:[o]):[],i[r]=c.data.simpleData.enable?g.transformTozTreeFormat(c,o):o,g.initCache(c),N.unbindTree(c),N.bindTree(c),N.unbindEvent(c),N.bindEvent(c);var l={setting:c,addNodes:function(e,d,t,a){function o(){C.addNodes(c,e,d,i,!0==a)}if(e||(e=null),e&&!e.isParent&&c.data.keep.leaf)return null;var n=parseInt(d,10);if(isNaN(n)?(a=!!t,t=d,d=-1):d=n,!t)return null;var i=k.clone(k.isArray(t)?t:[t]);return k.canAsync(c,e)?C.asyncNode(c,e,a,o):o(),i},cancelSelectedNode:function(e){C.cancelPreSelectedNode(c,e)},destroy:function(){C.destroy(c)},expandAll:function(e){return e=!!e,C.expandCollapseSonNode(c,null,e,!0),e},expandNode:function(e,d,t,o,a){function n(){var d=m(e,c).get(0);d&&!1!==o&&C.scrollIntoView(d)}return e&&e.isParent?(!0!==d&&!1!==d&&(d=!e.open),a=!!a,a&&d&&!1==k.apply(c.callback.beforeExpand,[c.treeId,e],!0))?null:a&&!d&&!1==k.apply(c.callback.beforeCollapse,[c.treeId,e],!0)?null:(d&&e.parentTId&&C.expandCollapseParentNode(c,e.getParentNode(),d,!1),d===e.open&&!t)?null:(g.getRoot(c).expandTriggerFlag=a,!k.canAsync(c,e)&&t?C.expandCollapseSonNode(c,e,d,!0,n):(e.open=!d,C.switchNode(this.setting,e),n()),d):null},getNodes:function(){return g.getNodes(c)},getNodeByParam:function(e,d,t){return e?g.getNodeByParam(c,t?t[c.data.key.children]:g.getNodes(c),e,d):null},getNodeByTId:function(e){return g.getNodeCache(c,e)},getNodesByParam:function(e,d,t){return e?g.getNodesByParam(c,t?t[c.data.key.children]:g.getNodes(c),e,d):null},getNodesByParamFuzzy:function(e,d,t){return e?g.getNodesByParamFuzzy(c,t?t[c.data.key.children]:g.getNodes(c),e,d):null},getNodesByFilter:function(e,d,t,a){return d=!!d,e&&"function"==typeof e?g.getNodesByFilter(c,t?t[c.data.key.children]:g.getNodes(c),e,d,a):d?null:[]},getNodeIndex:function(e){if(!e)return null;for(var d=c.data.key.children,t=e.parentTId?e.getParentNode():g.getRoot(c),a=0,o=t[d].length;a<o;a++)if(t[d][a]==e)return a;return-1},getSelectedNodes:function(){for(var e=[],d=g.getRoot(c).curSelectedList,t=0,a=d.length;t<a;t++)e.push(d[t]);return e},isSelectedNode:function(e){return g.isSelectedNode(c,e)},reAsyncChildNodes:function(e,d,t){if(this.setting.async.enable){var a=!e;if(a&&(e=g.getRoot(c)),"refresh"==d){for(var o=this.setting.data.key.children,n=0,i=e[o]?e[o].length:0;n<i;n++)g.removeNodeCache(c,e[o][n]);if(g.removeSelectedNode(c),e[o]=[],a)this.setting.treeObj.empty();else{var r=m(e,T.id.UL,c);r.empty()}}C.asyncNode(this.setting,a?null:e,!!t)}},refresh:function(){this.setting.treeObj.empty();var e=g.getRoot(c),d=e[c.data.key.children];g.initRoot(c),e[c.data.key.children]=d,g.initCache(c),C.createNodes(c,0,e[c.data.key.children],null,-1)},removeChildNodes:function(e){if(!e)return null;var d=c.data.key.children,t=e[d];return C.removeChildNodes(c,e),t?t:null},removeNode:function(e,d){e&&(d=!!d,d&&!1==k.apply(c.callback.beforeRemove,[c.treeId,e],!0)||(C.removeNode(c,e),d&&this.setting.treeObj.trigger(T.event.REMOVE,[c.treeId,e])))},selectNode:function(e,d,t){function a(){if(!t){var d=m(e,c).get(0);C.scrollIntoView(d)}}if(e&&k.uCanDo(c)){if(d=c.view.selectedMulti&&d,e.parentTId)C.expandCollapseParentNode(c,e.getParentNode(),!0,!1,a);else try{m(e,c).focus().blur()}catch(d){}C.selectNode(c,e,d)}},transformTozTreeNodes:function(e){return g.transformTozTreeFormat(c,e)},transformToArray:function(e){return g.transformToArrayFormat(c,e)},updateNode:function(e){if(e){var d=m(e,c);d.get(0)&&k.uCanDo(c)&&(C.setNodeName(c,e),C.setNodeTarget(c,e),C.setNodeUrl(c,e),C.setNodeLineIcos(c,e),C.setNodeFontCss(c,e))}}};return i.treeTools=l,g.setZTreeTools(c,l),i[r]&&0<i[r].length?C.createNodes(c,0,i[r],null,-1):c.async.enable&&c.async.url&&""!==c.async.url&&C.asyncNode(c),l}};var u=e.fn.zTree,m=k.$,T=u.consts})(jQuery),function(e){var d={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},t={check:{enable:!1,autoCheckTrigger:!1,chkStyle:d.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:d.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},a={onCheckNode:function(e,d){if(!0===d.chkDisabled)return!1;var t=c.getSetting(e.data.treeId),a=t.data.key.checked;if(!1==i.apply(t.callback.beforeCheck,[t.treeId,d],!0))return!0;d[a]=!d[a],n.checkNodeRelation(t,d);var o=h(d,s.id.CHECK,t);return n.setChkClass(t,o,d),n.repairParentChkClassWithSelf(t,d),t.treeObj.trigger(s.event.CHECK,[e,t.treeId,d]),!0},onMouseoverCheck:function(e,d){if(!0===d.chkDisabled)return!1;var t=c.getSetting(e.data.treeId),a=h(d,s.id.CHECK,t);return d.check_Focus=!0,n.setChkClass(t,a,d),!0},onMouseoutCheck:function(e,d){if(!0===d.chkDisabled)return!1;var t=c.getSetting(e.data.treeId),a=h(d,s.id.CHECK,t);return d.check_Focus=!1,n.setChkClass(t,a,d),!0}};e.extend(!0,e.fn.zTree.consts,d),e.extend(!0,e.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(e,d){var t,a,o,i=e.data.key.children,l=e.data.key.checked,p=s.radio;if(e.check.chkStyle==p.STYLE){var r=c.getRadioCheckedList(e);if(d[l]){if(e.check.radioType==p.TYPE_ALL){for(a=r.length-1;0<=a;a--)t=r[a],t[l]&&t!=d&&(t[l]=!1,r.splice(a,1),n.setChkClass(e,h(t,s.id.CHECK,e),t),t.parentTId!=d.parentTId&&n.repairParentChkClassWithSelf(e,t));r.push(d)}else{var g=d.parentTId?d.getParentNode():c.getRoot(e);for(a=0,o=g[i].length;a<o;a++)t=g[i][a],t[l]&&t!=d&&(t[l]=!1,n.setChkClass(e,h(t,s.id.CHECK,e),t))}}else if(e.check.radioType==p.TYPE_ALL)for(a=0,o=r.length;a<o;a++)if(d==r[a]){r.splice(a,1);break}}else d[l]&&(!d[i]||0==d[i].length||-1<e.check.chkboxType.Y.indexOf("s"))&&n.setSonNodeCheckBox(e,d,!0),d[l]||d[i]&&0!=d[i].length&&!(-1<e.check.chkboxType.N.indexOf("s"))||n.setSonNodeCheckBox(e,d,!1),d[l]&&-1<e.check.chkboxType.Y.indexOf("p")&&n.setParentNodeCheckBox(e,d,!0),!d[l]&&-1<e.check.chkboxType.N.indexOf("p")&&n.setParentNodeCheckBox(e,d,!1)},makeChkClass:function(e,d){var t=e.data.key.checked,a=s.checkbox,o=s.radio,n="";n=!0===d.chkDisabled?a.DISABLED:d.halfCheck?a.PART:e.check.chkStyle==o.STYLE?1>d.check_Child_State?a.FULL:a.PART:d[t]?2===d.check_Child_State||-1===d.check_Child_State?a.FULL:a.PART:1>d.check_Child_State?a.FULL:a.PART;var i=e.check.chkStyle+"_"+(d[t]?a.TRUE:a.FALSE)+"_"+n;return i=d.check_Focus&&!0!==d.chkDisabled?i+"_"+a.FOCUS:i,s.className.BUTTON+" "+a.DEFAULT+" "+i},repairAllChk:function(e,d){if(e.check.enable&&e.check.chkStyle===s.checkbox.STYLE)for(var t,a=e.data.key.checked,o=e.data.key.children,r=c.getRoot(e),h=0,i=r[o].length;h<i;h++)t=r[o][h],!0!==t.nocheck&&!0!==t.chkDisabled&&(t[a]=d),n.setSonNodeCheckBox(e,t,d)},repairChkClass:function(e,d){if(d&&(c.makeChkFlag(e,d),!0!==d.nocheck)){var t=h(d,s.id.CHECK,e);n.setChkClass(e,t,d)}},repairParentChkClass:function(e,d){if(d&&d.parentTId){var t=d.getParentNode();n.repairChkClass(e,t),n.repairParentChkClass(e,t)}},repairParentChkClassWithSelf:function(e,d){if(d){var t=e.data.key.children;d[t]&&0<d[t].length?n.repairParentChkClass(e,d[t][0]):n.repairParentChkClass(e,d)}},repairSonChkDisabled:function(e,d,t,a){if(d){var o=e.data.key.children;if(d.chkDisabled!=t&&(d.chkDisabled=t),n.repairChkClass(e,d),d[o]&&a)for(var r,c=0,i=d[o].length;c<i;c++)r=d[o][c],n.repairSonChkDisabled(e,r,t,a)}},repairParentChkDisabled:function(e,d,t,a){d&&(d.chkDisabled!=t&&a&&(d.chkDisabled=t),n.repairChkClass(e,d),n.repairParentChkDisabled(e,d.getParentNode(),t,a))},setChkClass:function(e,d,t){d&&(!0===t.nocheck?d.hide():d.show(),d.attr("class",n.makeChkClass(e,t)))},setParentNodeCheckBox:function(e,d,t,a){var o=e.data.key.children,r=e.data.key.checked,p=h(d,s.id.CHECK,e);if(a||(a=d),c.makeChkFlag(e,d),!0!==d.nocheck&&!0!==d.chkDisabled&&(d[r]=t,n.setChkClass(e,p,d),e.check.autoCheckTrigger&&d!=a&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,d])),d.parentTId){var g=!0;if(!t)for(var N=d.getParentNode()[o],y=0,i=N.length;y<i;y++)if(!0!==N[y].nocheck&&!0!==N[y].chkDisabled&&N[y][r]||(!0===N[y].nocheck||!0===N[y].chkDisabled)&&0<N[y].check_Child_State){g=!1;break}g&&n.setParentNodeCheckBox(e,d.getParentNode(),t,a)}},setSonNodeCheckBox:function(e,d,t,a){if(d){var o=e.data.key.children,r=e.data.key.checked,p=h(d,s.id.CHECK,e);a||(a=d);var g=!1;if(d[o])for(var N,y=0,i=d[o].length;y<i;y++)N=d[o][y],n.setSonNodeCheckBox(e,N,t,a),!0===N.chkDisabled&&(g=!0);d!=c.getRoot(e)&&!0!==d.chkDisabled&&(g&&!0!==d.nocheck&&c.makeChkFlag(e,d),!0!==d.nocheck&&!0!==d.chkDisabled?(d[r]=t,!g&&(d.check_Child_State=d[o]&&0<d[o].length?t?2:0:-1)):d.check_Child_State=-1,n.setChkClass(e,p,d),e.check.autoCheckTrigger&&d!=a&&!0!==d.nocheck&&!0!==d.chkDisabled&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,d]))}}},event:{},data:{getRadioCheckedList:function(e){for(var d=c.getRoot(e).radioCheckedList,t=0,a=d.length;t<a;t++)c.getNodeCache(e,d[t].tId)||(d.splice(t,1),t--,a--);return d},getCheckStatus:function(e,d){if(!e.check.enable||d.nocheck||d.chkDisabled)return null;var t=e.data.key.checked,a={checked:d[t],half:d.halfCheck?d.halfCheck:e.check.chkStyle==s.radio.STYLE?2===d.check_Child_State:d[t]?-1<d.check_Child_State&&2>d.check_Child_State:0<d.check_Child_State};return a},getTreeCheckedNodes:function(e,d,t,a){if(!d)return[];var o=e.data.key.children,n=e.data.key.checked,r=t&&e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL;a=a?a:[];for(var h=0,i=d.length;h<i&&!(!0!==d[h].nocheck&&!0!==d[h].chkDisabled&&d[h][n]==t&&(a.push(d[h]),r))&&!(c.getTreeCheckedNodes(e,d[h][o],t,a),r&&0<a.length);h++);return a},getTreeChangeCheckedNodes:function(e,d,t){if(!d)return[];var a=e.data.key.children,o=e.data.key.checked;t=t?t:[];for(var n=0,i=d.length;n<i;n++)!0!==d[n].nocheck&&!0!==d[n].chkDisabled&&d[n][o]!=d[n].checkedOld&&t.push(d[n]),c.getTreeChangeCheckedNodes(e,d[n][a],t);return t},makeChkFlag:function(e,d){if(d){var t=e.data.key.children,a=e.data.key.checked,o=-1;if(d[t])for(var n=0,i=d[t].length;n<i;n++){var r=d[t][n],l=-1;if(e.check.chkStyle==s.radio.STYLE){if(l=!0===r.nocheck||!0===r.chkDisabled?r.check_Child_State:!0===r.halfCheck?2:r[a]?2:0<r.check_Child_State?2:0,2==l){o=2;break}else 0==l&&(o=0);}else if(e.check.chkStyle==s.checkbox.STYLE)if(l=!0===r.nocheck||!0===r.chkDisabled?r.check_Child_State:!0===r.halfCheck?1:r[a]?-1===r.check_Child_State||2===r.check_Child_State?2:1:0<r.check_Child_State?1:0,1===l){o=1;break}else if(2===l&&-1<o&&0<n&&l!==o){o=1;break}else if(2==o&&-1<l&&2>l){o=1;break}else-1<l&&(o=l)}d.check_Child_State=o}}}});var o=e.fn.zTree,i=o._z.tools,s=o.consts,n=o._z.view,c=o._z.data,r=o._z.event,h=i.$;c.exSetting(t),c.addInitBind(function(e){var d=e.treeObj,t=s.event;d.bind(t.CHECK,function(d,t,a,o){d.srcEvent=t,i.apply(e.callback.onCheck,[d,a,o])})}),c.addInitUnBind(function(e){var d=e.treeObj,t=s.event;d.unbind(t.CHECK)}),c.addInitCache(function(){}),c.addInitNode(function(e,d,t,a){if(t){var o=e.data.key.checked;if("string"==typeof t[o]&&(t[o]=i.eqs(t[o],"true")),t[o]=!!t[o],t.checkedOld=t[o],"string"==typeof t.nocheck&&(t.nocheck=i.eqs(t.nocheck,"true")),t.nocheck=!!t.nocheck||e.check.nocheckInherit&&a&&!!a.nocheck,"string"==typeof t.chkDisabled&&(t.chkDisabled=i.eqs(t.chkDisabled,"true")),t.chkDisabled=!!t.chkDisabled||e.check.chkDisabledInherit&&a&&!!a.chkDisabled,"string"==typeof t.halfCheck&&(t.halfCheck=i.eqs(t.halfCheck,"true")),t.halfCheck=!!t.halfCheck,t.check_Child_State=-1,t.check_Focus=!1,t.getCheckStatus=function(){return c.getCheckStatus(e,t)},e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL&&t[o]){var n=c.getRoot(e);n.radioCheckedList.push(t)}}}),c.addInitProxy(function(d){var e=d.target,t=c.getSetting(d.data.treeId),o="",n=null,r="",l=null;i.eqs(d.type,"mouseover")?t.check.enable&&i.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+s.id.CHECK)&&(o=i.getNodeMainDom(e).id,r="mouseoverCheck"):i.eqs(d.type,"mouseout")?t.check.enable&&i.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+s.id.CHECK)&&(o=i.getNodeMainDom(e).id,r="mouseoutCheck"):i.eqs(d.type,"click")&&t.check.enable&&i.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+s.id.CHECK)&&(o=i.getNodeMainDom(e).id,r="checkNode");0<o.length&&(n=c.getNodeCache(t,o),"checkNode"==r?l=a.onCheckNode:"mouseoverCheck"==r?l=a.onMouseoverCheck:"mouseoutCheck"==r?l=a.onMouseoutCheck:void 0);var h={stop:"checkNode"==r,node:n,nodeEventType:r,nodeEventCallback:l,treeEventType:"",treeEventCallback:null};return h},!0),c.addInitRoot(function(e){var d=c.getRoot(e);d.radioCheckedList=[]}),c.addBeforeA(function(e,d,t){e.data.key.checked;e.check.enable&&(c.makeChkFlag(e,d),t.push("<span ID='",d.tId,s.id.CHECK,"' class='",n.makeChkClass(e,d),"' treeNode",s.id.CHECK,!0===d.nocheck?" style='display:none;'":"","></span>"))}),c.addZTreeTools(function(e,d){d.checkNode=function(e,d,t,a){var o=this.setting.data.key.checked;if(!0!==e.chkDisabled&&(!0!==d&&!1!==d&&(d=!e[o]),a=!!a,e[o]!==d||t)&&!(a&&!1==i.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0))&&i.uCanDo(this.setting)&&this.setting.check.enable&&!0!==e.nocheck){e[o]=d;var r=h(e,s.id.CHECK,this.setting);(t||this.setting.check.chkStyle===s.radio.STYLE)&&n.checkNodeRelation(this.setting,e),n.setChkClass(this.setting,r,e),n.repairParentChkClassWithSelf(this.setting,e),a&&this.setting.treeObj.trigger(s.event.CHECK,[null,this.setting.treeId,e])}},d.checkAllNodes=function(e){n.repairAllChk(this.setting,!!e)},d.getCheckedNodes=function(e){var d=this.setting.data.key.children;return e=!1!==e,c.getTreeCheckedNodes(this.setting,c.getRoot(this.setting)[d],e)},d.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return c.getTreeChangeCheckedNodes(this.setting,c.getRoot(this.setting)[e])},d.setChkDisabled=function(e,d,t,a){d=!!d,t=!!t,a=!!a,n.repairSonChkDisabled(this.setting,e,d,a),n.repairParentChkDisabled(this.setting,e.getParentNode(),d,t)};var t=d.updateNode;d.updateNode=function(e,a){if(t&&t.apply(d,arguments),e&&this.setting.check.enable){var o=h(e,this.setting);if(o.get(0)&&i.uCanDo(this.setting)){var r=h(e,s.id.CHECK,this.setting);(!0==a||this.setting.check.chkStyle===s.radio.STYLE)&&n.checkNodeRelation(this.setting,e),n.setChkClass(this.setting,r,e),n.repairParentChkClassWithSelf(this.setting,e)}}}});var l=n.createNodes;n.createNodes=function(e,d,t,a){l&&l.apply(n,arguments);t&&n.repairParentChkClassWithSelf(e,a)};var p=n.removeNode;n.removeNode=function(e,d){var t=d.getParentNode();p&&p.apply(n,arguments);d&&t&&(n.repairChkClass(e,t),n.repairParentChkClass(e,t))};var g=n.appendNodes;n.appendNodes=function(e,d,t,a){var o="";return g&&(o=g.apply(n,arguments)),a&&c.makeChkFlag(e,a),o}}(jQuery),function(e){var d={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},t={onHoverOverNode:function(e,d){var a=c.getSetting(e.data.treeId),o=c.getRoot(a);o.curHoverNode!=d&&t.onHoverOutNode(e),o.curHoverNode=d,r.addHoverDom(a,d)},onHoverOutNode:function(e){var d=c.getSetting(e.data.treeId),t=c.getRoot(d);t.curHoverNode&&!c.isSelectedNode(d,t.curHoverNode)&&(r.removeTreeDom(d,t.curHoverNode),t.curHoverNode=null)},onMousedownNode:function(t,a){function h(t){var a=Math.abs;if(0==k.dragFlag&&a(_-t.clientX)<y.edit.drag.minMoveSize&&a(x-t.clientY)<y.edit.drag.minMoveSize)return!0;var h,i,l,g,N,u=y.data.key.children;if(S.css("cursor","pointer"),0==k.dragFlag){if(!1==o.apply(y.callback.beforeDrag,[y.treeId,m],!0))return p(t),!0;for(h=0,i=m.length;h<i;h++)0==h&&(k.dragNodeShowBefore=[]),l=m[h],l.isParent&&l.open?(r.expandCollapseNode(y,l,!l.open),k.dragNodeShowBefore[l.tId]=!0):k.dragNodeShowBefore[l.tId]=!1;k.dragFlag=1,C.showHoverDom=!1,o.showIfameMask(y,!0);var R=!0,w=-1;if(1<m.length){var U=m[0].parentTId?m[0].getParentNode()[u]:c.getNodes(y);for(N=[],h=0,i=U.length;h<i;h++)if(void 0!==k.dragNodeShowBefore[U[h].tId]&&(R&&-1<w&&w+1!==h&&(R=!1),N.push(U[h]),w=h),m.length===N.length){m=N;break}}for(R&&(b=m[0].getPreNode(),I=m[m.length-1].getNextNode()),T=s("<ul class='zTreeDragUL'></ul>",y),(h=0,i=m.length);h<i;h++)(l=m[h],l.editNameFlag=!1,r.selectNode(y,l,0<h),r.removeTreeDom(y,l),!(h>y.edit.drag.maxShowNodeNum-1))&&(g=s("<li id='"+l.tId+"_tmp'></li>",y),g.append(s(l,n.id.A,y).clone()),g.css("padding","0"),g.children("#"+l.tId+n.id.A).removeClass(n.node.CURSELECTED),T.append(g),h==y.edit.drag.maxShowNodeNum-1&&(g=s("<li id='"+l.tId+"_moretmp'><a>  ...  </a></li>",y),T.append(g)));T.attr("id",m[0].tId+n.id.UL+"_tmp"),T.addClass(y.treeObj.attr("class")),T.appendTo(S),E=s("<span class='tmpzTreeMove_arrow'></span>",y),E.attr("id","zTreeMove_arrow_tmp"),E.appendTo(S),y.treeObj.trigger(n.event.DRAG,[t,y.treeId,m])}if(1==k.dragFlag){if(f&&E.attr("id")==t.target.id&&L&&t.clientX+v.scrollLeft()+2>e("#"+L+n.id.A,f).offset().left){var j=e("#"+L+n.id.A,f);t.target=0<j.length?j.get(0):t.target}else f&&(f.removeClass(n.node.TMPTARGET_TREE),L&&e("#"+L+n.id.A,f).removeClass(n.node.TMPTARGET_NODE+"_"+n.move.TYPE_PREV).removeClass(n.node.TMPTARGET_NODE+"_"+d.move.TYPE_NEXT).removeClass(n.node.TMPTARGET_NODE+"_"+d.move.TYPE_INNER));f=null,L=null,P=!1,O=y;var B=c.getSettings();for(var F in B)B[F].treeId&&B[F].edit.enable&&B[F].treeId!=y.treeId&&(t.target.id==B[F].treeId||0<e(t.target).parents("#"+B[F].treeId).length)&&(P=!0,O=B[F]);var z=v.scrollTop(),Y=v.scrollLeft(),H=O.treeObj.offset(),V=O.treeObj.get(0).scrollHeight,q=O.treeObj.get(0).scrollWidth,W=t.clientY+z-H.top,G=O.treeObj.height()+H.top-t.clientY-z,X=t.clientX+Y-H.left,Z=O.treeObj.width()+H.left-t.clientX-Y,$=W<y.edit.drag.borderMax&&W>y.edit.drag.borderMin,Q=G<y.edit.drag.borderMax&&G>y.edit.drag.borderMin,J=X<y.edit.drag.borderMax&&X>y.edit.drag.borderMin,ee=Z<y.edit.drag.borderMax&&Z>y.edit.drag.borderMin,de=W>y.edit.drag.borderMin&&G>y.edit.drag.borderMin&&X>y.edit.drag.borderMin&&Z>y.edit.drag.borderMin,te=$&&0>=O.treeObj.scrollTop(),ae=Q&&O.treeObj.scrollTop()+O.treeObj.height()+10>=V,oe=J&&0>=O.treeObj.scrollLeft(),ne=ee&&O.treeObj.scrollLeft()+O.treeObj.width()+10>=q;if(t.target&&o.isChildOrSelf(t.target,O.treeId)){for(var ie=t.target;ie&&ie.tagName&&!o.eqs(ie.tagName,"li")&&ie.id!=O.treeId;)ie=ie.parentNode;var re=!0;for(h=0,i=m.length;h<i;h++)if(l=m[h],ie.id===l.tId){re=!1;break}else if(0<s(l,y).find("#"+ie.id).length){re=!1;break}re&&t.target&&o.isChildOrSelf(t.target,ie.id+n.id.A)&&(f=e(ie),L=ie.id)}l=m[0],de&&o.isChildOrSelf(t.target,O.treeId)&&(!f&&(t.target.id==O.treeId||te||ae||oe||ne)&&(P||!P&&l.parentTId)&&(f=O.treeObj),$?O.treeObj.scrollTop(O.treeObj.scrollTop()-10):Q&&O.treeObj.scrollTop(O.treeObj.scrollTop()+10),J?O.treeObj.scrollLeft(O.treeObj.scrollLeft()-10):ee&&O.treeObj.scrollLeft(O.treeObj.scrollLeft()+10),f&&f!=O.treeObj&&f.offset().left<O.treeObj.offset().left&&O.treeObj.scrollLeft(O.treeObj.scrollLeft()+f.offset().left-O.treeObj.offset().left)),T.css({top:t.clientY+z+3+"px",left:t.clientX+Y+3+"px"});var le=0,ce=0;if(f&&f.attr("id")!=O.treeId){function d(){f=null,L="",A=n.move.TYPE_INNER,E.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}var se=null==L?null:c.getNodeCache(O,L),he=(t.ctrlKey||t.metaKey)&&y.edit.drag.isMove&&y.edit.drag.isCopy||!y.edit.drag.isMove&&y.edit.drag.isCopy,pe=!!(b&&L===b.tId),ge=!!(I&&L===I.tId),Ne=l.parentTId&&l.parentTId==L,ye=(he||!ge)&&o.apply(O.edit.drag.prev,[O.treeId,m,se],!!O.edit.drag.prev),ke=(he||!pe)&&o.apply(O.edit.drag.next,[O.treeId,m,se],!!O.edit.drag.next),Ce=(he||!Ne)&&(!O.data.keep.leaf||se.isParent)&&o.apply(O.edit.drag.inner,[O.treeId,m,se],!!O.edit.drag.inner);if(!ye&&!ke&&!Ce)d();else{var ue=e("#"+L+n.id.A,f),me=se.isLastNode?null:e("#"+se.getNextNode().tId+n.id.A,f.next()),Te=ue.offset().top,Ee=ue.offset().left,fe=ye?Ce?0.25:ke?0.5:1:-1,be=ke?Ce?0.75:ye?0.5:0:-1,Ie=(t.clientY+z-Te)/ue.height();if((1==fe||Ie<=fe&&-.2<=Ie)&&ye?(le=1-E.width(),ce=Te-E.height()/2,A=n.move.TYPE_PREV):(0==be||Ie>=be&&1.2>=Ie)&&ke?(le=1-E.width(),ce=null==me||se.isParent&&se.open?Te+ue.height()-E.height()/2:me.offset().top-E.height()/2,A=n.move.TYPE_NEXT):Ce?(le=5-E.width(),ce=Te,A=n.move.TYPE_INNER):d(),f&&(E.css({display:"block",top:ce+"px",left:Ee+le+"px"}),ue.addClass(n.node.TMPTARGET_NODE+"_"+A),(D!=L||K!=A)&&(M=new Date().getTime()),se&&se.isParent&&A==n.move.TYPE_INNER)){var ve=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==se.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===se.tId&&(ve=!1),ve&&(window.zTreeMoveTimer=setTimeout(function(){A!=n.move.TYPE_INNER||se&&se.isParent&&!se.open&&new Date().getTime()-M>O.edit.drag.autoOpenTime&&o.apply(O.callback.beforeDragOpen,[O.treeId,se],!0)&&(r.switchNode(O,se),O.edit.drag.autoExpandTrigger&&O.treeObj.trigger(n.event.EXPAND,[O.treeId,se]))},O.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=se.tId)}}}else A=n.move.TYPE_INNER,f&&o.apply(O.edit.drag.inner,[O.treeId,m,null],!!O.edit.drag.inner)?f.addClass(n.node.TMPTARGET_TREE):f=null,E.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);D=L,K=A,y.treeObj.trigger(n.event.DRAGMOVE,[t,y.treeId,m])}return!1}function p(t){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),D=null,K=null,v.unbind("mousemove",h),v.unbind("mouseup",p),v.unbind("selectstart",g),S.css("cursor","auto"),f&&(f.removeClass(n.node.TMPTARGET_TREE),L&&e("#"+L+n.id.A,f).removeClass(n.node.TMPTARGET_NODE+"_"+n.move.TYPE_PREV).removeClass(n.node.TMPTARGET_NODE+"_"+d.move.TYPE_NEXT).removeClass(n.node.TMPTARGET_NODE+"_"+d.move.TYPE_INNER)),o.showIfameMask(y,!1),C.showHoverDom=!0,0!=k.dragFlag){k.dragFlag=0;var a,i,l;for(a=0,i=m.length;a<i;a++)l=m[a],l.isParent&&k.dragNodeShowBefore[l.tId]&&!l.open&&(r.expandCollapseNode(y,l,!l.open),delete k.dragNodeShowBefore[l.tId]);T&&T.remove(),E&&E.remove();var N=(t.ctrlKey||t.metaKey)&&y.edit.drag.isMove&&y.edit.drag.isCopy||!y.edit.drag.isMove&&y.edit.drag.isCopy;if(!N&&f&&L&&m[0].parentTId&&L==m[0].parentTId&&A==n.move.TYPE_INNER&&(f=null),f){function e(){if(P){if(!N)for(var e=0,d=m.length;e<d;e++)r.removeNode(y,m[e]);A==n.move.TYPE_INNER?r.addNodes(O,u,-1,b):r.addNodes(O,u.getParentNode(),A==n.move.TYPE_PREV?u.getIndex():u.getIndex()+1,b)}else if(N&&A==n.move.TYPE_INNER)r.addNodes(O,u,-1,b);else if(N)r.addNodes(O,u.getParentNode(),A==n.move.TYPE_PREV?u.getIndex():u.getIndex()+1,b);else if(A!=n.move.TYPE_NEXT)for(e=0,d=b.length;e<d;e++)r.moveNode(O,u,b[e],A,!1);else for(e=-1,d=b.length-1;e<d;d--)r.moveNode(O,u,b[d],A,!1);r.selectNodes(O,b);var o=s(b[0],y).get(0);r.scrollIntoView(o),y.treeObj.trigger(n.event.DROP,[t,O.treeId,b,u,A,N])}var u=null==L?null:c.getNodeCache(O,L);if(!1==o.apply(y.callback.beforeDrop,[O.treeId,m,u,A,N],!0))return void r.selectNodes(R,m);var b=N?o.clone(m):m;A==n.move.TYPE_INNER&&o.canAsync(O,u)?r.asyncNode(O,u,!1,e):e()}else r.selectNodes(R,m),y.treeObj.trigger(n.event.DROP,[t,y.treeId,m,null,null,null])}}function g(){return!1}var N,i,y=c.getSetting(t.data.treeId),k=c.getRoot(y),C=c.getRoots();if(2==t.button||!y.edit.enable||!y.edit.drag.isCopy&&!y.edit.drag.isMove)return!0;var l=t.target,u=c.getRoot(y).curSelectedList,m=[];if(!c.isSelectedNode(y,a))m=[a];else for(N=0,i=u.length;N<i;N++){if(u[N].editNameFlag&&o.eqs(l.tagName,"input")&&null!==l.getAttribute("treeNode"+n.id.INPUT))return!0;if(m.push(u[N]),m[0].parentTId!==u[N].parentTId){m=[a];break}}r.editNodeBlur=!0,r.cancelCurEditNode(y);var T,E,f,b,I,v=e(y.treeObj.get(0).ownerDocument),S=e(y.treeObj.get(0).ownerDocument.body),P=!1,O=y,R=y,D=null,K=null,L=null,A=n.move.TYPE_INNER,_=t.clientX,x=t.clientY,M=new Date().getTime();return o.uCanDo(y)&&v.bind("mousemove",h),v.bind("mouseup",p),v.bind("selectstart",g),t.preventDefault&&t.preventDefault(),!0}};e.extend(!0,e.fn.zTree.consts,d),e.extend(!0,e.fn.zTree._z,{tools:{getAbs:function(e){var d=e.getBoundingClientRect(),t=document.body.scrollTop+document.documentElement.scrollTop,a=document.body.scrollLeft+document.documentElement.scrollLeft;return[d.left+a,d.top+t]},inputFocus:function(e){e.get(0)&&(e.focus(),o.setCursorPosition(e.get(0),e.val().length))},inputSelect:function(e){e.get(0)&&(e.focus(),e.select())},setCursorPosition:function(e,d){if(e.setSelectionRange)e.focus(),e.setSelectionRange(d,d);else if(e.createTextRange){var t=e.createTextRange();t.collapse(!0),t.moveEnd("character",d),t.moveStart("character",d),t.select()}},showIfameMask:function(e,d){for(var t=c.getRoot(e);0<t.dragMaskList.length;)t.dragMaskList[0].remove(),t.dragMaskList.shift();if(d)for(var a=s("iframe",e),n=0,i=a.length;n<i;n++){var l=a.get(n),h=o.getAbs(l),r=s("<div id='zTreeMask_"+n+"' class='zTreeMask' style='top:"+h[1]+"px; left:"+h[0]+"px; width:"+l.offsetWidth+"px; height:"+l.offsetHeight+"px;'></div>",e);r.appendTo(s("body",e)),t.dragMaskList.push(r)}}},view:{addEditBtn:function(e,d){if(!(d.editNameFlag||0<s(d,n.id.EDIT,e).length)&&o.apply(e.edit.showRenameBtn,[e.treeId,d],e.edit.showRenameBtn)){var t=s(d,n.id.A,e),a="<span class='"+n.className.BUTTON+" edit' id='"+d.tId+n.id.EDIT+"' title='"+o.apply(e.edit.renameTitle,[e.treeId,d],e.edit.renameTitle)+"' treeNode"+n.id.EDIT+" style='display:none;'></span>";t.append(a),s(d,n.id.EDIT,e).bind("click",function(){return o.uCanDo(e)&&!1!=o.apply(e.callback.beforeEditName,[e.treeId,d],!0)&&(r.editNode(e,d),!1)}).show()}},addRemoveBtn:function(e,d){if(!(d.editNameFlag||0<s(d,n.id.REMOVE,e).length)&&o.apply(e.edit.showRemoveBtn,[e.treeId,d],e.edit.showRemoveBtn)){var t=s(d,n.id.A,e),a="<span class='"+n.className.BUTTON+" remove' id='"+d.tId+n.id.REMOVE+"' title='"+o.apply(e.edit.removeTitle,[e.treeId,d],e.edit.removeTitle)+"' treeNode"+n.id.REMOVE+" style='display:none;'></span>";t.append(a),s(d,n.id.REMOVE,e).bind("click",function(){return o.uCanDo(e)&&!1!=o.apply(e.callback.beforeRemove,[e.treeId,d],!0)&&(r.removeNode(e,d),e.treeObj.trigger(n.event.REMOVE,[e.treeId,d]),!1)}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(e,d){c.getRoots().showHoverDom&&(d.isHover=!0,e.edit.enable&&(r.addEditBtn(e,d),r.addRemoveBtn(e,d)),o.apply(e.view.addHoverDom,[e.treeId,d]))},cancelCurEditNode:function(e,d,t){var a=c.getRoot(e),i=e.data.key.name,l=a.curEditNode;if(l){var h=a.curEditInput,p=d?d:t?l[i]:h.val();if(!1===o.apply(e.callback.beforeRename,[e.treeId,l,p,t],!0))return!1;l[i]=p;var g=s(l,n.id.A,e);g.removeClass(n.node.CURSELECTED_EDIT),h.unbind(),r.setNodeName(e,l),l.editNameFlag=!1,a.curEditNode=null,a.curEditInput=null,r.selectNode(e,l,!1),e.treeObj.trigger(n.event.RENAME,[e.treeId,l,t])}return a.noSelection=!0,!0},editNode:function(e,d){var t=c.getRoot(e);if(r.editNodeBlur=!1,c.isSelectedNode(e,d)&&t.curEditNode==d&&d.editNameFlag)return void setTimeout(function(){o.inputFocus(t.curEditInput)},0);var a=e.data.key.name;d.editNameFlag=!0,r.removeTreeDom(e,d),r.cancelCurEditNode(e),r.selectNode(e,d,!1),s(d,n.id.SPAN,e).html("<input type=text class='rename' id='"+d.tId+n.id.INPUT+"' treeNode"+n.id.INPUT+" >");var i=s(d,n.id.INPUT,e);i.attr("value",d[a]),e.edit.editNameSelectAll?o.inputSelect(i):o.inputFocus(i),i.bind("blur",function(){r.editNodeBlur||r.cancelCurEditNode(e)}).bind("keydown",function(d){"13"==d.keyCode?(r.editNodeBlur=!0,r.cancelCurEditNode(e)):"27"==d.keyCode&&r.cancelCurEditNode(e,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),s(d,n.id.A,e).addClass(n.node.CURSELECTED_EDIT),t.curEditInput=i,t.noSelection=!1,t.curEditNode=d},moveNode:function(e,d,t,a,o,h){var p=c.getRoot(e),g=e.data.key.children;if(d!=t&&!(e.data.keep.leaf&&d&&!d.isParent&&a==n.move.TYPE_INNER)){var N=t.parentTId?t.getParentNode():p,y=null===d||d==p;y&&null===d&&(d=p),y&&(a=n.move.TYPE_INNER);var k=d.parentTId?d.getParentNode():p;a!=n.move.TYPE_PREV&&a!=n.move.TYPE_NEXT&&(a=n.move.TYPE_INNER),a==n.move.TYPE_INNER&&(y?t.parentTId=null:(!d.isParent&&(d.isParent=!0,d.open=!!d.open,r.setNodeLineIcos(e,d)),t.parentTId=d.tId));var C,u;if(y)C=e.treeObj,u=C;else{if(h||a!=n.move.TYPE_INNER?!h&&r.expandCollapseNode(e,d.getParentNode(),!0,!1):r.expandCollapseNode(e,d,!0,!1),C=s(d,e),u=s(d,n.id.UL,e),!!C.get(0)&&!u.get(0)){var m=[];r.makeUlHtml(e,d,m,""),C.append(m.join(""))}u=s(d,n.id.UL,e)}var T=s(t,e);T.get(0)?!C.get(0)&&T.remove():T=r.appendNodes(e,t.level,[t],null,-1,!1,!0).join(""),u.get(0)&&a==n.move.TYPE_INNER?u.append(T):C.get(0)&&a==n.move.TYPE_PREV?C.before(T):C.get(0)&&a==n.move.TYPE_NEXT&&C.after(T);var E,i,l=-1,f=0,b=null,I=null,v=t.level;if(t.isFirstNode)l=0,1<N[g].length&&(b=N[g][1],b.isFirstNode=!0);else if(t.isLastNode)l=N[g].length-1,b=N[g][l-1],b.isLastNode=!0;else for(E=0,i=N[g].length;E<i;E++)if(N[g][E].tId==t.tId){l=E;break}if(0<=l&&N[g].splice(l,1),a!=n.move.TYPE_INNER)for(E=0,i=k[g].length;E<i;E++)k[g][E].tId==d.tId&&(f=E);if(a==n.move.TYPE_INNER?(!d[g]&&(d[g]=[]),0<d[g].length&&(I=d[g][d[g].length-1],I.isLastNode=!1),d[g].splice(d[g].length,0,t),t.isLastNode=!0,t.isFirstNode=1==d[g].length):d.isFirstNode&&a==n.move.TYPE_PREV?(k[g].splice(f,0,t),I=d,I.isFirstNode=!1,t.parentTId=d.parentTId,t.isFirstNode=!0,t.isLastNode=!1):d.isLastNode&&a==n.move.TYPE_NEXT?(k[g].splice(f+1,0,t),I=d,I.isLastNode=!1,t.parentTId=d.parentTId,t.isFirstNode=!1,t.isLastNode=!0):(a==n.move.TYPE_PREV?k[g].splice(f,0,t):k[g].splice(f+1,0,t),t.parentTId=d.parentTId,t.isFirstNode=!1,t.isLastNode=!1),c.fixPIdKeyValue(e,t),c.setSonNodeLevel(e,t.getParentNode(),t),r.setNodeLineIcos(e,t),r.repairNodeLevelClass(e,t,v),!e.data.keep.parent&&1>N[g].length){N.isParent=!1,N.open=!1;var S=s(N,n.id.UL,e),P=s(N,n.id.SWITCH,e),O=s(N,n.id.ICON,e);r.replaceSwitchClass(N,P,n.folder.DOCU),r.replaceIcoClass(N,O,n.folder.DOCU),S.css("display","none")}else b&&r.setNodeLineIcos(e,b);I&&r.setNodeLineIcos(e,I),!!e.check&&e.check.enable&&r.repairChkClass&&(r.repairChkClass(e,N),r.repairParentChkClassWithSelf(e,N),N!=t.parent&&r.repairParentChkClassWithSelf(e,t)),h||r.expandCollapseParentNode(e,t.getParentNode(),!0,o)}},removeEditBtn:function(e,d){s(d,n.id.EDIT,e).unbind().remove()},removeRemoveBtn:function(e,d){s(d,n.id.REMOVE,e).unbind().remove()},removeTreeDom:function(e,d){d.isHover=!1,r.removeEditBtn(e,d),r.removeRemoveBtn(e,d),o.apply(e.view.removeHoverDom,[e.treeId,d])},repairNodeLevelClass:function(e,d,t){if(t!==d.level){var a=s(d,e),o=s(d,n.id.A,e),i=s(d,n.id.UL,e),r=n.className.LEVEL+t,l=n.className.LEVEL+d.level;a.removeClass(r),a.addClass(l),o.removeClass(r),o.addClass(l),i.removeClass(r),i.addClass(l)}},selectNodes:function(e,d){for(var t=0,a=d.length;t<a;t++)r.selectNode(e,d[t],0<t)}},event:{},data:{setSonNodeLevel:function(e,d,t){if(t){var a=e.data.key.children;if(t.level=d?d.level+1:0,!!t[a])for(var o=0,n=t[a].length;o<n;o++)t[a][o]&&c.setSonNodeLevel(e,t,t[a][o])}}}});var a=e.fn.zTree,o=a._z.tools,n=a.consts,r=a._z.view,c=a._z.data,i=a._z.event,s=o.$;c.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}}),c.addInitBind(function(e){var d=e.treeObj,t=n.event;d.bind(t.RENAME,function(d,t,a,n){o.apply(e.callback.onRename,[d,t,a,n])}),d.bind(t.DRAG,function(d,t,a,n){o.apply(e.callback.onDrag,[t,a,n])}),d.bind(t.DRAGMOVE,function(d,t,a,n){o.apply(e.callback.onDragMove,[t,a,n])}),d.bind(t.DROP,function(d,t,a,n,i,r,l){o.apply(e.callback.onDrop,[t,a,n,i,r,l])})}),c.addInitUnBind(function(e){var d=e.treeObj,t=n.event;d.unbind(t.RENAME),d.unbind(t.DRAG),d.unbind(t.DRAGMOVE),d.unbind(t.DROP)}),c.addInitCache(function(){}),c.addInitNode(function(e,d,t){t&&(t.isHover=!1,t.editNameFlag=!1)}),c.addInitProxy(function(d){var e=d.target,a=c.getSetting(d.data.treeId),i=d.relatedTarget,r="",l=null,s="",h=null,p=null;o.eqs(d.type,"mouseover")?(p=o.getMDom(a,e,[{tagName:"a",attrName:"treeNode"+n.id.A}]),p&&(r=o.getNodeMainDom(p).id,s="hoverOverNode")):o.eqs(d.type,"mouseout")?(p=o.getMDom(a,i,[{tagName:"a",attrName:"treeNode"+n.id.A}]),!p&&(r="remove",s="hoverOutNode")):o.eqs(d.type,"mousedown")&&(p=o.getMDom(a,e,[{tagName:"a",attrName:"treeNode"+n.id.A}]),p&&(r=o.getNodeMainDom(p).id,s="mousedownNode"));0<r.length&&(l=c.getNodeCache(a,r),"mousedownNode"==s?h=t.onMousedownNode:"hoverOverNode"==s?h=t.onHoverOverNode:"hoverOutNode"==s?h=t.onHoverOutNode:void 0);var g={stop:!1,node:l,nodeEventType:s,nodeEventCallback:h,treeEventType:"",treeEventCallback:null};return g}),c.addInitRoot(function(e){var d=c.getRoot(e),t=c.getRoots();d.curEditNode=null,d.curEditInput=null,d.curHoverNode=null,d.dragFlag=0,d.dragNodeShowBefore=[],d.dragMaskList=[],t.showHoverDom=!0}),c.addZTreeTools(function(e,d){d.cancelEditName=function(e){var d=c.getRoot(this.setting);d.curEditNode&&r.cancelCurEditNode(this.setting,e?e:null,!0)},d.copyNode=function(e,d,t,a){if(!d)return null;if(e&&!e.isParent&&this.setting.data.keep.leaf&&t===n.move.TYPE_INNER)return null;var i=this,l=o.clone(d);if(e||(e=null,t=n.move.TYPE_INNER),t==n.move.TYPE_INNER){function d(){r.addNodes(i.setting,e,-1,[l],a)}o.canAsync(this.setting,e)?r.asyncNode(this.setting,e,a,d):d()}else r.addNodes(this.setting,e.parentNode,-1,[l],a),r.moveNode(this.setting,e,l,t,!1,a);return l},d.editName=function(e){e&&e.tId&&e===c.getNodeCache(this.setting,e.tId)&&(e.parentTId&&r.expandCollapseParentNode(this.setting,e.getParentNode(),!0),r.editNode(this.setting,e))},d.moveNode=function(e,d,t,a){function i(){r.moveNode(l.setting,e,d,t,!1,a)}if(!d)return d;if(e&&!e.isParent&&this.setting.data.keep.leaf&&t===n.move.TYPE_INNER)return null;if(e&&(d.parentTId==e.tId&&t==n.move.TYPE_INNER||0<s(d,this.setting).find("#"+e.tId).length))return null;e||(e=null);var l=this;return o.canAsync(this.setting,e)&&t===n.move.TYPE_INNER?r.asyncNode(this.setting,e,a,i):i(),d},d.setEditable=function(e){return this.setting.edit.enable=e,this.refresh()}});var l=r.cancelPreSelectedNode;r.cancelPreSelectedNode=function(e,d){for(var t=c.getRoot(e).curSelectedList,a=0,o=t.length;a<o&&!((!d||d===t[a])&&(r.removeTreeDom(e,t[a]),d));a++);l&&l.apply(r,arguments)};var h=r.createNodes;r.createNodes=function(e,d,t,a){h&&h.apply(r,arguments);!t||r.repairParentChkClassWithSelf&&r.repairParentChkClassWithSelf(e,a)};var p=r.makeNodeUrl;r.makeNodeUrl=function(e){return e.edit.enable?null:p.apply(r,arguments)};var g=r.removeNode;r.removeNode=function(e,d){var t=c.getRoot(e);t.curEditNode===d&&(t.curEditNode=null),g&&g.apply(r,arguments)};var N=r.selectNode;r.selectNode=function(e,d){var t=c.getRoot(e);return c.isSelectedNode(e,d)&&t.curEditNode==d&&d.editNameFlag?!1:(N&&N.apply(r,arguments),r.addHoverDom(e,d),!0)};var y=o.uCanDo;o.uCanDo=function(d,t){var e=c.getRoot(d);return t&&(o.eqs(t.type,"mouseover")||o.eqs(t.type,"mouseout")||o.eqs(t.type,"mousedown")||o.eqs(t.type,"mouseup"))||(e.curEditNode&&(r.editNodeBlur=!1,e.curEditInput.focus()),!e.curEditNode&&(!y||y.apply(r,arguments)))}}(jQuery);